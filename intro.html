

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Inchman 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Inchman 2.0 documentation" href="index.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Inchman User Guide" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Inchman User Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Inchman 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Reaction-diffusion systems can be used to model a large variety of complex self-organized phenomena occurring in biological, chemical, and social systems. The common macroscopic description of these systems, based on a Fokker-Planck equation (FPE), suffers from major limitations. Most importantly, it fails at low particle densities and it is impossible to incorporate individual-level experimental observations. A microscopic Langevin-type individual-based description can – in principle – address these issues but is challenging and computationally expensive to the point that hardware limitations severely restrict their applicability to models of realistic size. Inchman is a graphics-processor-accelerated stochastic simulation solver that obtains performance gains of up to two orders of magnitude even on workstations. We provide a versatile web-based editor allowing researcher to perform complex experiments and parameter studies. Inchman allows users to upload models of chemical reaction networks written in <a class="reference external" href="http://sbml.org/Main_Page">SBML</a>, the lingua franca of systems biology, amend them with spatial information and run large-scale simulations.</p>
<p>Inchman provides an implementation of a spatially-resolved stochastic simulation algorithm on general-purpose graphics processing units (GPUs). This algorithm, designed to solve reaction-drift-diffusion equations on a mesoscopic level, has widespread applications in computational biology, molecular chemistry and social systems research. For our implementation, we use the Gillespie multi-particle method, which is well-suited for GPUs. Using this algorithm, we could obtain speed ups of several orders of magnitudes as compared to standard implementations on CPUs.</p>
</div>
<div class="section" id="reaction-drift-diffusion-systems">
<h2>Reaction-Drift-Diffusion Systems<a class="headerlink" href="#reaction-drift-diffusion-systems" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.scholarpedia.org/article/Reaction-diffusion_systems">Reaction-drift-diffusion networks</a> are systems consisting of one or more interacting entities (e.g. molecules in a solution) which propagate in space through (possibly biased) random walks. In many applications, most notably in a biological and chemical context, the number of participating agents is small and the inherently stochastic nature of the problem requires a microscopic description of the system, in which the position of every species is known at all times. On a microscopic level, the spatial movement of individuals can be described by an Ito stochastic-differential equation (SDE):</p>
<div class="math" id="equation-sde">
<span class="eqno">(1)</span>\[\mathrm{d} \mathbf{X}_t=\mathbf{q}(\mathbf{X}_t, t)\, \mathrm{d}t +\mathbf{b}(\mathbf{X}_t, t)\, \mathrm{d} \mathbf{W}_t\]</div>
<p>where <span class="math">\(\mathbf{X}_t\)</span> is a stochastic process denoting the position of an individual in space. <span class="math">\(\mathbf{W}_t\)</span> is a multi-variable Wiener process. Statistical averaging of Eq. <a href="#equation-sde">(1)</a> yields the corresponding Fokker-Planck-Equation (FPE), which has the form of a classical drift-diffusion equation</p>
<div class="math">
\[\frac{\partial}{\partial t} p(\mathbf{x},t) = - \sum_i \frac{\partial}{\partial x_i} \left[q_i (\mathbf{x}, t) p(\mathbf{x},t) \right] + \frac{1}{2} \sum_{i,j} \frac{\partial^2}{\partial x_i \partial x_j} \left\{ \left[\mathbf{b}(\mathbf{x}, t) \mathbf{\cdot} \mathbf{b^\mathrm{T}}(\mathbf{x}, t)\right]_{i,j} p(\mathbf{x},t)\right\}.\]</div>
</div>
<div class="section" id="gillespie-multiparticle-algorithm">
<h2>Gillespie-Multiparticle Algorithm<a class="headerlink" href="#gillespie-multiparticle-algorithm" title="Permalink to this headline">¶</a></h2>
<img alt="_images/gmp_basic.png" class="align-right" src="_images/gmp_basic.png" />
<p>A wide variety of stochastic simulation algorithms exist to compute single realizations of reaction diffusion networks (see, e.g., <a class="reference internal" href="#vigelius2010">[Vigelius2010]</a>, <a class="reference internal" href="tutorial.html#vigelius2012a">[Vigelius2012a]</a> for a brief overview). Gillespie&#8217;s direct method <a class="reference internal" href="#gillespie2007">[Gillespie2007]</a> has emerged as a standard method to simulate spatially homogeneous reaction networks. Very efficient adaptations of this algorithm exist, such as the next-reaction method or the logarithmic direct method (consult <a class="reference internal" href="#pahle2009">[Pahle2009]</a> for a review). Based on the first reaction method is a prominent algorithm to simulate spatially inhomogeneous reaction-diffusion networks, the next-subvolume method <a class="reference internal" href="#elf2004">[Elf2004]</a>. The popular software packages <a class="reference external" href="http://software.crg.es/smartcell/">Smartcell</a> and <a class="reference external" href="http://mesord.sourceforge.net/">MesoRD</a> can handle the next-reaction and the next-subvolume methods. The fastest implementation of the next-subvolume method so far is the stochastic simulation compiler <a class="reference internal" href="#lis2009">[Lis2009]</a>.</p>
<p>All algorithms in the previous paragraph compute exact realizations of stochastic reaction-diffusion systems. The disadvantage of these methods is their high computational cost, in particular, if a fine granularity is required and the number of subvolumes is high. Furthermore, they do not lend themselves well for data-parallel implementations. However, if one is willing to sacrifice accuracy for speed, deterministic-stochastic hybrid algorithms provide an efficient alternative. In these methods, the diffusion part is separated from the reaction part and treated deterministically. The Gillespie multiparticle method (GMP) <a class="reference internal" href="#rodriguez2006">[Rodriguez2006]</a> is one example of this class of algorithms.</p>
<p>GMP handles the diffusion part of the reaction-diffusion network trough a multiparticle lattice gas automaton and the reaction part via Gillespie&#8217;s direct method. The time step is chosen globally according to the diffusion constants of each species and the dimensions of each lattice cell. In each iteration, all reactions are performed independently in each subvolume. At the end of the time step all particles are diffused according to the cellular automaton rule. Accomodating spatially inhomogeneous systems with a drift field is substantially harder <a class="reference internal" href="tutorial.html#vigelius2012a">[Vigelius2012a]</a>. In particular, the time step needs to be computed for each cell separately and the global time step is minimized over the domain. The transition probabilities in each cell then need to be scaled to the new time step. Details about how this can be achieved are found in <a class="reference internal" href="tutorial.html#vigelius2012a">[Vigelius2012a]</a>.</p>
</div>
<div class="section" id="gpu-implementation">
<h2>GPU Implementation<a class="headerlink" href="#gpu-implementation" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/inchman-cluster.svg"><img src="_images/inchman-cluster.svg" /></a>
<p>With the advent of general-purpose graphics processing units there is potential to provide super-computing resources to a broad audience. GPUs are ubiquitous and comparably cheap and designated units can be mounted in work station computers for better performance. GPUs provide a multitude of processing threads which are executed in parallel. We devised a data-parallel implementation of GMP on GPUs, allowing researchers to efficiently simulate spatially-inhomogeneous reaction-diffusion networks. The latest extensions support fully non-linear, inhomogeneous, reaction-drift-diffusion simulations. Even on common work stations, it can still provide speed gains of one to two orders of magnitude. The particular strength of the GPU-accelerated approach unfolds when a GPU cluster is used. In this case, a second level of parallelization over experiments is possible which result in another several orders of magnitued performance gain. This two-level parallelization enables complex experiments, such as parameter sweeps or even parameter optimization, and thus unlocks entirely new application areas.</p>
</div>
<div class="section" id="basic-workflow">
<h2>Basic Workflow<a class="headerlink" href="#basic-workflow" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/basic_inchman.svg"><img src="_images/basic_inchman.svg" /></a>
<p>The Inchman package consists of the web-based <a class="reference internal" href="editor.html#section-editor"><em>Editor</em></a> and the command-line client. The editor creates an SBML file which is amended with Inchman-specific information, in particular the spatial setup and the simulation paramters. The command-line client works on these files and creates an <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a> file. HDF5 files are supported by most major software packages, in particular, Python, Matlab and Mathematica.</p>
<p>The general workflow, which would be sufficient for most applications, is as follows:</p>
<ol class="arabic simple">
<li>Create your reaction-drift-diffusion network using the <a class="reference internal" href="editor.html#section-editor"><em>Editor</em></a>.</li>
<li>Save it to an SBML file or directly send it to the Inchman client.</li>
<li>Simulate the model on your computer (or on any GPU-enabled machine).</li>
<li>Retrieve the output HDF5 file and analyze it (using Python, Matlab, Mathematica..)</li>
</ol>
<p>Alternatively, you could do any of the following (from simple to very advanced):</p>
<ul class="simple">
<li>Use your favourite SBML editor (e.g. <a class="reference external" href="http://www.celldesigner.org/">CellDesigner</a>) to create a non-spatial SBML file and amend it with Inchman</li>
<li>Write up the spatial SBML files yourself (not recommended) or use a script to generate them</li>
<li>The core simulation module is a shared library so you can link your own code to this library, use the Inchman C++ API to build the model and simulate it.</li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="elf2004" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[Elf2004]</a></td><td>Elf J., Ehrenberg, M. (2004): <a class="reference external" href="http://ieeexplore.ieee.org/xpl/abstractSimilar.jsp?tp=&amp;arnumber=1389215&amp;url=http%3A%2F%2Fieeexplore.ieee.org%2Fxpls%2Fabs_all.jsp%3Farnumber%3D1389215">Spontaneous separation of bi-stable biochemical systems into spatial domains of opposite phases</a> Systems Biology, IEE Proceedings , vol.1, no.2, pp.230,236, 1 Dec. 2004 doi: 10.1049/sb:20045021</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gillespie2007" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Gillespie2007]</a></td><td>Gillespie D T (2007): <a class="reference external" href="http://www.annualreviews.org/doi/abs/10.1146/annurev.physchem.58.032806.104637?url_ver=Z39.88-2003&amp;rfr_dat=cr_pub%3Dpubmed&amp;rfr_id=ori%3Arid%3Acrossref.org&amp;journalCode=physchem">Stochastic Simulation of Chemical Kinetics</a> Annual Review of Physical Chemistry 58: 35-55</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="lis2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[Lis2009]</a></td><td>Lis M, Artyomov M N, Devadas S, Chakraborty A. K. (2009). <a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/25/17/2289.full">Efficient stochastic simulation of reaction-diffusion processes via direct compilation.</a> Bioinformatics, 25(17), 2289–2291.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="pahle2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Pahle2009]</a></td><td>Pahle J (2009): <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2638628/">Biochemical simulations: stochastic, approximate stochastic and hybrid approaches</a> Brief Bioinform. 10(1): 53–64.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rodriguez2006" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[Rodriguez2006]</a></td><td>Rodriguez J V, Kaandorp J A, Dobrzyski M, Blom J G (2006). <a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/22/15/1895.full">Spatial stochastic modelling of the phosphoenolpyruvate-dependent phosphotransferase (pts) pathway in escherichia coli.</a> Bioinformatics, 22(15), 1895–1901.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="vigelius2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Vigelius2010]</a></td><td>Vigelius M, Lane A, Meyer B (2010):  <a class="reference external" href="http://bioinformatics.oxfordjournals.org/content/27/2/288">Accelerating reaction–diffusion simulations with general-purpose graphics processing units</a>  Bioinformatics (2011) 27 (2): 288-290.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="vigelius2012a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Vigelius2012a]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id8">2</a>, <a class="fn-backref" href="#id9">3</a>)</em> Vigelius M, Meyer B (2012a) <a class="reference external" href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0033384">Multi-Dimensional, Mesoscopic Monte Carlo Simulations of Inhomogeneous Reaction-Drift-Diffusion Systems on Graphics-Processing Units.</a> PLoS ONE 7(4): e33384. doi:10.1371/journal.pone.0033384</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="vigelius2012b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Vigelius2012b]</td><td>Vigelius M, Meyer B (2012b): <a class="reference external" href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0042508">Stochastic Simulations of Pattern Formation in Excitable Media.</a> PLoS ONE 7(8): e42508. doi:10.1371/journal.pone.0042508</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#reaction-drift-diffusion-systems">Reaction-Drift-Diffusion Systems</a></li>
<li><a class="reference internal" href="#gillespie-multiparticle-algorithm">Gillespie-Multiparticle Algorithm</a></li>
<li><a class="reference internal" href="#gpu-implementation">GPU Implementation</a></li>
<li><a class="reference internal" href="#basic-workflow">Basic Workflow</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Inchman User Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="installation.html"
                        title="next chapter">Installation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/intro.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Inchman User Guide"
             >previous</a> |</li>
        <li><a href="index.html">Inchman 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Matthias Vigelius, Aidan Lane, Bernd Meyer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>